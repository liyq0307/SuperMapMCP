import importlib
import locale
import os

# 尝试匹配语言对应模块，比如zh_CN 匹配顺序一次为 '_zh_CN' -> '_zh' -> '' 为后缀的模块
# 语言默认模块
default_language_module = 'iobjectspy._locales.iobjectspy'

try:
    language_all = locale.getdefaultlocale()[0]
    language_short = language_all.split('_')[0]
except Exception:
    language_all = 'en'
    language_short = 'en'

try:
    _compile_make_doc_language_short = os.environ.get('_compile_make_doc_language_short')
    if _compile_make_doc_language_short:
        language_short = _compile_make_doc_language_short
except Exception:
    pass

# 判断环境变量DISABLEICLIENTPYI18N是否存在，存在则不启用国际化翻译的docstrings，不存在则使用国际化翻译的dostrings
hook = os.environ.get('DISABLEICLIENTPYI18N') is None and (language_short != 'zh')

language_module = default_language_module

if hook:
    try:
        language_module = default_language_module + '_' + language_all
        importlib.import_module(language_module)
    except Exception:
        try:
            language_module = default_language_module + '_' + language_short
            importlib.import_module(language_module)
        except Exception:
            language_module = default_language_module

# 在语言模块内字典名称
locale_member_name = 'iobjectspy_locale'
