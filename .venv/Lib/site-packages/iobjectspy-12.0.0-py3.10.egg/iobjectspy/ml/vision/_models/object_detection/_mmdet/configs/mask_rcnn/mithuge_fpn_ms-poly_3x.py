_base_ = [
    '../_base_/custom_imports.py',
    '../common/ms-poly_3x_coco-instance.py',
    '../_base_/models/mask-rcnn_r50_fpn.py'
]

model = dict(
    backbone=dict(
        type='MixVisionTransformer',
        embed_dims=[256, 512, 1024, 2048],
        num_heads=[4, 8, 16, 32],
        attn_drop_rate=0.,
        drop_path_rate=0.2,
        depths=[3, 4, 18, 3],
        use_chk_=False,
        norm_cfg=dict(type='LN', requires_grad=True),
        style='pytorch',
        init_cfg=dict(type='Pretrained', checkpoint='torchvision://mithuge')
    ),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5
    ),
)

optim_wrapper = dict(
    type='OptimWrapper',
    optimizer=dict(
        _delete_=True,
        type='AdamW',
        lr=0.0001,
        betas=(0.9, 0.999),
        weight_decay=0.05)
)
