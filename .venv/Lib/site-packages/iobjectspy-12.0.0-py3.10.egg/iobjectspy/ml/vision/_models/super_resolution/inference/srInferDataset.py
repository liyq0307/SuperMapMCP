from torch.utils.data import Dataset
import numpy as np


class SrInferDataset(Dataset):
    def __init__(self, img, windows):
        self.img = img
        self.windows = windows

    def __getitem__(self, index):
        tile = self.img.read(window=self.windows[index])
        tile = tile.astype(np.float32)
        return tile, index

    def __len__(self):
        return len(self.windows)
