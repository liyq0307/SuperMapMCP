from .api import SegTorchTrainer
from .api import SegTorchEstimation_CD
from ._torch_models import build_torch_seg_model


class DsamnetTrainer(SegTorchTrainer):

    def get_loss_type(self):
        if len(self.sda_data_config.dataset.class_type) > 2:
            self.loss_type = 'crossentropyloss'
        else:
            self.loss_type = 'bcl_loss'


class DsamnetEstimation(SegTorchEstimation_CD):
    def __init__(self, model_path, config, gpus, batch_size, test_aug=False, **kwargs):
        super(DsamnetEstimation, self).__init__(model_path, config, gpus, batch_size, test_aug, **kwargs)
        pass
