import os
import tempfile

from iobjectspy._jsuperpy._utils import check_lic
from ..analyst._tabular.automl import AutoMLEstimater


class AutoMLTabularInference:
    def __init__(self, model_path):
        """
        模型推理初始化入口

        :param model_path: 模型存储路径
        :type  model_path: str
        """
        self.model_path = model_path
        self.estimater = AutoMLEstimater(self.model_path)
        check_lic()

    def infer(self, input_data, out_data, out_dataset_name=None):
        """
        模型推理功能入口

        :param input_data: 输入数据路径，暂时只支持csv
        :param out_data: 输出数据路径，暂时只支持csv
        :param out_dataset_name: 输出文件名
        :return: （预测结果 ，输出数据路径）
        """
        result = self.estimater.estimate_file(input_data, out_data, out_dataset_name)

        return result
