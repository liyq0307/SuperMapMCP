from iobjectspy._jsuperpy._utils import check_lic
from ..analyst._tabular.classification import ClsEstimater


class TabularInference:
    def __init__(self, model_path, **kwargs):
        """
        表格数据模型推理初始化入口

        :param model_path: 模型存储路径
        :type  model_path: str
        """
        self.model_path = model_path
        self.kwargs = kwargs
        check_lic()

    def cls_infer(self, input_data, out_data, out_dataset_name=None, **kwargs):
        """
        表格数据模型推理功能入口

        :param input_data: 输入数据路径，暂时只支持csv
        :param out_data: 输出数据路径，暂时只支持csv
        :param out_dataset_name: 输出文件名
        :param kwargs: 其他参数
        :return: （预测结果 ，输出数据路径）
        """
        result = ClsEstimater(self.model_path, **self.kwargs).estimate_file(input_data, out_data, out_dataset_name)

        return result
